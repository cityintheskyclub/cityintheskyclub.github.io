"use strict";(self["webpackChunkbetly_dapp"]=self["webpackChunkbetly_dapp"]||[]).push([[955],{72373:function(e,t,s){s.d(t,{Z:function(){return k}});var n=s(73396),o=s(87139),a=s(49242),l=s(44870),i=(s(8666),s(31754)),c=s(57071),d=s(41258);const r={class:"bind allFlex column"},h={class:"popup-title Wcolor font-Eight font500 center"},p={key:0,class:"bind_ipt center Wcolor"},u={class:"bgPadding flex_between"};var m={__name:"swapAlert",props:{finish:Boolean,success:Boolean,hash:String,type:String,text:String,title:String,btn:String,empowerText:String,empower:Boolean,check:Boolean},emits:["closeFn","empowerFn","submit"],setup(e,{emit:t}){const s=e,{hash:m}=(0,l.BK)(s),{toClipboard:w}=((0,i.l)(),(0,c.Z)());return(t,s)=>{const i=(0,n.up)("van-button");return(0,n.wg)(),(0,n.iD)("div",r,[(0,n.wy)((0,n._)("span",{class:(0,o.C_)(["success-btn Wcolor font-Two",[e.success?"btnBg":"redBg"]])},(0,o.zw)(e.success?t.$t("success"):t.$t("fail")),3),[[a.F8,e.finish]]),(0,n.wy)((0,n.Wm)(d.Z,{class:"loading"},null,512),[[a.F8,!e.finish&&e.check]]),(0,n._)("p",h,(0,o.zw)(t.$t(e.title)),1),e.finish?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",p,[(0,n.WI)(t.$slots,"default")])),e.finish?((0,n.wg)(),(0,n.iD)("div",{key:1,class:(0,o.C_)(["bind_ipt bgPadding center",[e.success?"mainColor font-Ty":"redColor hashFont font-Four"]])},(0,o.zw)(e.success?t.$t(e.text):(0,l.SU)(m)),3)):(0,n.kq)("",!0),(0,n._)("div",u,[e.empower?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(i,{key:0,type:"primary",block:"",disabled:e.check,class:"font-Three",onClick:s[0]||(s[0]=e=>t.$emit("empowerFn"))},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(t.$t(e.empowerText)),1)])),_:1},8,["disabled"])),(0,n.wy)((0,n.Wm)(i,{class:"btn font-Three",type:"primary",disabled:!e.empower||e.check,block:"",onClick:s[1]||(s[1]=e=>t.$emit("submit"))},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(t.$t(e.btn)),1)])),_:1},8,["disabled"]),[[a.F8,!e.finish]]),(0,n.wy)((0,n.Wm)(i,{class:"btn font-Three",type:e.success?"primary":"danger",block:"",onClick:s[2]||(s[2]=e=>t.$emit("closeFn"))},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(t.$t("SwapAlert.close")),1)])),_:1},8,["type"]),[[a.F8,e.finish]])])])}}},w=s(40089);const f=(0,w.Z)(m,[["__scopeId","data-v-58a1f06e"]]);var k=f},4955:function(e,t,s){s.r(t),s.d(t,{default:function(){return W}});s(59813);var n=s(97668),o=(s(57658),s(73396)),a=s(87139),l=s(44870);var i=s(40089);var c=s(49242),d=s(84739),r=s(22483),h=s(31754);const p={class:"nft-list padding flex_between"};var u={__name:"nftList",props:{list:Array,counts:Array,type:String,countTime:Array},emits:["toSell"],setup(e,{emit:t}){const s=e,{type:n,countTime:a}=((0,h.l)(),(0,l.BK)(s)),i=(0,r.tv)(),u=(e,t)=>{if("hasBuy"==n.value)return;const s={color:e.color-1,index:e.index,tokenid:e?.tokenid||e?.tokenId,canvasid:e.canvasid,type_:e.type_,endDate:a.value[t]};i.push({path:"/nftDetails",query:s})},m=e=>{t("toSell",e)};return(t,s)=>((0,o.wg)(),(0,o.iD)("div",p,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.list,((t,s)=>((0,o.wg)(),(0,o.j4)(d.Z,{key:s,pixelInfo:t,name:"nft",btnType:"primary",btnText:"NFT.sell",type:(0,l.SU)(n),endDate:(0,l.SU)(a)[s],onToSell:m,count:e.counts[s],onClick:(0,c.iM)((e=>u(t,s)),["stop"])},null,8,["pixelInfo","type","endDate","count","onClick"])))),128))]))}};const m=(0,i.Z)(u,[["__scopeId","data-v-4dbec983"]]);var w=m;const f={class:"nft-list padding flex_between"};var k={__name:"sellList",props:{list:Array,counts:Array,type:String},emits:["toCancel"],setup(e,{emit:t}){(0,r.tv)();const s=(e,s)=>{t("toCancel",e,s)};return(t,n)=>((0,o.wg)(),(0,o.iD)("div",f,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.list,((t,a)=>((0,o.wg)(),(0,o.j4)(d.Z,{key:a,pixelInfo:t,name:"nft",btnType:"primary",btnText:"NFT.cancel",type:e.type,count:e.counts[a],onToCancel:s,onClick:n[0]||(n[0]=(0,c.iM)((()=>{}),["stop"]))},null,8,["pixelInfo","type","count"])))),128))]))}};const y=(0,i.Z)(k,[["__scopeId","data-v-3bc38ab5"]]);var g=y,T=s(72373),v=s(5741),b=s(15941);const _={class:"mynft"},x={class:"record-tabs"},S={class:"record-tabs"},C={key:0,class:"font-Four"},L={key:1,class:"font-Four"};var F={__name:"index",setup(e){const t=(0,h.l)(),s=(0,l.qj)({holdList:[],sellList:[],allList:[],active:0,counts:[],sellCounts:[],allCounts:[],countTime:[],loading:!0,finished:!1,page:0,empower:!1,empowerText:"EmpowerAlert.btn2",check:!1}),i=(0,l.qj)({alertShow:!1,finish:!1,success:!1,hash:"",tokenid:"",id:"",hashType:"cancel"}),c=async()=>{s.loading=!0;try{s.holdList=await t.allMethods.getUserPixel(t.address).call(),s.loading=!1,t.setLoading(!1);const e=[];s.holdList=s.holdList.map((e=>({...e,id:e.index}))),b.log(s.holdList),s.holdList.forEach((t=>{t.id=t.index;const s=t?.tokenid||t?.tokenId;e.push(s)})),d(0,e)}catch(e){(0,n.Z)(e)}},d=async(e,n)=>{const o=await t.marketMethods.listNftCount(n).call();0==e?(s.counts=s.counts.concat(o.counts_),s.countTime=s.countTime.concat(o.times_)):1==e?s.sellCounts=s.sellCounts.concat(o.counts_):s.allCounts=s.allCounts.concat(o.counts_)},r=()=>{(0,v.Ok)(t.address,s.page).then((e=>{s.loading=!1,t.setLoading(!1);const n=e.data.results;s.sellList=s.sellList.concat(n),s.finished=n.length<20;const o=[];s.sellList.forEach((e=>{o.push(e.tokenId)})),s.sellLoad=!0,d(1,o)}))},p=()=>{s.finished||(s.page++,s.loading=!0,r())};(0,o.wF)((()=>{t.initMarketWeb3()})),(0,o.m0)((()=>{t.marketEmpower&&t.address&&(t.setLoading(!0),s.active=0,c())})),(0,o.YP)((()=>s.active),(e=>{t.setLoading(!0),s.page=0,s.loading=!0,s.sellCounts=[],s.allCounts=[],s.counts=[],s.countTime=[],0==e?(s.holdList=[],c()):1==e&&(s.sellList=[],r())}));const u=async e=>{i.tokenid=e,b.log(e);try{const n=await t.allMethods.getApproved(e).call();s.empower=n==t.market_address,i.hashType="sell",i.alertShow=!0,i.finish=!1,i.success=!1}catch(o){b.log(o),(0,n.Z)(o)}},m=async()=>{if(!s.check){s.check=!0,s.empowerText="EmpowerAlert.btn1";try{await t.allMethods.approve(t.market_address,i.tokenid).send({from:t.address});s.check=!1,s.empower=!0,s.empowerText="EmpowerAlert.btn2"}catch(e){s.check=!1,s.empowerText="EmpowerAlert.btn2",(0,n.Z)(e)}}},f=async()=>{if(!s.check){s.check=!0;try{const e=await t.marketMethods.sell(i.tokenid).send({from:t.address});i.finish=!0,i.success=!0,s.check=!1,i.hash=e.transactionHash,t.addHash(i.hash,1)}catch(e){i.finish=!0,i.success=!1,s.check=!1,i.hash=e.message}}},k=async(e,t)=>{i.hashType="cancel",i.alertShow=!0,i.finish=!1,i.success=!1,i.tokenid=t,i.id=e,s.empower=!0},y=async()=>{if(!s.check){s.check=!0;try{const e=await t.marketMethods.cancel(i.id).send({from:t.address});i.finish=!0,i.success=!0,i.hash=e.transactionHash,s.check=!1,t.addHash(i.hash,5)}catch(e){i.finish=!0,i.success=!1,s.check=!1,i.hash=e.message}}},F=()=>{t.setLoading(!0),i.alertShow=!1,s.page=0,0==s.active?(s.holdList=[],s.counts=[],c()):(s.sellCounts=[],s.sellList=[],r())},A=()=>{"sell"==i.hashType?f():y()};return(e,n)=>{const c=(0,o.up)("no-record"),d=(0,o.up)("van-tab"),r=(0,o.up)("van-list"),h=(0,o.up)("van-tabs"),f=(0,o.up)("van-popup");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",_,[(0,o.Wm)(h,{active:s.active,"onUpdate:active":n[1]||(n[1]=e=>s.active=e),"offset-top":"20","title-active-color":"#fff","title-inactive-color":"#999999",animated:""},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{title:e.$t("NFT.tabs.one"),"title-active-color":"#fff"},{default:(0,o.w5)((()=>[(0,o._)("div",x,[(0,o.Wm)(w,{list:s.holdList,type:"hold",counts:s.counts,onToSell:u,countTime:s.countTime},null,8,["list","counts","countTime"]),0!=s.holdList.length||s.loading?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(c,{key:0}))])])),_:1},8,["title"]),(0,o.Wm)(d,{title:e.$t("NFT.tabs.two")},{default:(0,o.w5)((()=>[(0,o._)("div",S,[(0,o.Wm)(r,{loading:s.loading,"onUpdate:loading":n[0]||(n[0]=e=>s.loading=e),finished:s.finished,"immediate-check":!1,"loading-text":e.$t("loadingText"),onLoad:p},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{list:s.sellList,counts:s.sellCounts,type:"sell",onToCancel:k,countTime:s.countTime},null,8,["list","counts","countTime"])])),_:1},8,["loading","finished","loading-text"]),0!=s.sellList.length||s.loading?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(c,{key:0}))])])),_:1},8,["title"])])),_:1},8,["active"])]),(0,o.Wm)(f,{show:i.alertShow,"onUpdate:show":n[2]||(n[2]=e=>i.alertShow=e)},{default:(0,o.w5)((()=>[(0,o.Wm)(T.Z,{finish:i.finish,success:i.success,hash:i.hash,onCloseFn:F,type:i.hashType,empower:s.empower,empowerText:s.empowerText,onEmpowerFn:m,check:s.check,onSubmit:A,title:"sell"==i.hashType?"SwapAlert.title6":"SwapAlert.title2",text:"sell"==i.hashType?"SwapAlert.success3":"SwapAlert.success2",btn:"sell"==i.hashType?"NFT.sell":"NFT.cancel"},{default:(0,o.w5)((()=>[(0,o._)("div",null,["sell"==i.hashType?((0,o.wg)(),(0,o.iD)("p",C,(0,a.zw)(e.$t("NFT.type1",{start:(0,l.SU)(t).address.slice(0,6),end:(0,l.SU)(t).address.slice(-4),tokenId:i.tokenid})),1)):(0,o.kq)("",!0),"cancel"==i.hashType?((0,o.wg)(),(0,o.iD)("p",L,(0,a.zw)(e.$t("NFT.type2",{start:(0,l.SU)(t).address.slice(0,6),end:(0,l.SU)(t).address.slice(-4),tokenId:i.tokenid})),1)):(0,o.kq)("",!0)])])),_:1},8,["finish","success","hash","type","empower","empowerText","check","title","text","btn"])])),_:1},8,["show"])],64)}}};const A=(0,i.Z)(F,[["__scopeId","data-v-628da430"]]);var W=A}}]);
//# sourceMappingURL=955.d212b01e.js.map